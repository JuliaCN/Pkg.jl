<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>6. 兼容性 · Pkg.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://ioxera.github.io/Pkg.jl/dev/compatibility/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Pkg.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Pkg.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../"><strong>1.</strong> 简介</a></li><li><a class="tocitem" href="../getting-started/"><strong>2.</strong> 入门</a></li><li><a class="tocitem" href="../managing-packages/"><strong>3.</strong> 管理包</a></li><li><a class="tocitem" href="../environments/"><strong>4.</strong> 使用“环境”</a></li><li><a class="tocitem" href="../creating-packages/"><strong>5.</strong> 创建包</a></li><li class="is-active"><a class="tocitem" href><strong>6.</strong> 兼容性</a><ul class="internal"><li><a class="tocitem" href="#版本说明符格式"><span>版本说明符格式</span></a></li><li><a class="tocitem" href="#修复冲突"><span>修复冲突</span></a></li></ul></li><li><a class="tocitem" href="../registries/"><strong>7.</strong> 注册表</a></li><li><a class="tocitem" href="../artifacts/"><strong>8.</strong> Artifacts</a></li><li><a class="tocitem" href="../glossary/"><strong>9.</strong> 词汇表</a></li><li><a class="tocitem" href="../toml-files/"><strong>10.</strong> <code>Project.toml</code> and <code>Manifest.toml</code></a></li><li><a class="tocitem" href="../repl/"><strong>11.</strong> REPL Mode Reference</a></li><li><a class="tocitem" href="../api/"><strong>12.</strong> API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href><strong>6.</strong> 兼容性</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href><strong>6.</strong> 兼容性</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ioxera/Pkg.jl/blob/master/docs/src/compatibility.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Compatibility"><a class="docs-heading-anchor" href="#Compatibility"><strong>6.</strong> 兼容性</a><a id="Compatibility-1"></a><a class="docs-heading-anchor-permalink" href="#Compatibility" title="Permalink"></a></h1><p>兼容性是指，限制你的项目兼容依赖包的版本的能力。如果未给出依赖包的兼容性，则假定项目与该依赖包的所有版本兼容。</p><p>在 <code>Project.toml</code> 文件中输入依赖包的兼容性，例如：</p><pre><code class="language-toml hljs">[compat]
julia = &quot;1.6&quot;
Example = &quot;0.5&quot;</code></pre><p>将兼容性条目放入项目文件后，<code>up</code> 命令可用于使它生效。</p><p>下面详细描述版本说明符的格式。</p><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>使用 <code>compat</code> 命令编辑 Pkg REPL 中的兼容条目，或手动编辑项目文件。</p></div></div><h2 id="版本说明符格式"><a class="docs-heading-anchor" href="#版本说明符格式">版本说明符格式</a><a id="版本说明符格式-1"></a><a class="docs-heading-anchor-permalink" href="#版本说明符格式" title="Permalink"></a></h2><p>与其他包管理器类似，Julia 包管理器尊重<a href="https://semver.org/">语义版本控制</a>(semver)。作为示例，假定版本说明符 <code>1.2.3</code> 与版本 <code>[1.2.3 - 2.0.0)</code>（<code>)</code> 指非闭合上界）是兼容的。更确切地说，版本说明符要么是<strong>插入(caret)说明符</strong>，例如 <code>^1.2.3</code>， 要么是<strong>波浪(tilde)说明符</strong>，例如 <code>~1.2.3</code>。插入说明符是默认值，因此 <code>1.2.3 == ^1.2.3</code>。插入符号和波浪号之间的区别将在下一节中描述。多个版本说明符的并集可以通过逗号分隔各个版本说明符来组成，例如</p><pre><code class="language-toml hljs">[compat]
Example = &quot;1.2, 3&quot;</code></pre><p>将得到 <code>[1.2.0, 3.0.0)</code>。请注意，前导零的处理方式不同，例如 <code>Example = &quot;0.2, 1&quot;</code> 只会得到 <code>[0.2.0 - 0.3.0) ∪ [1.0.0 - 2.0.0)</code>。有关带前导零的版本号的更多信息，请参阅下一节。</p><h3 id="compat-pre-1.0"><a class="docs-heading-anchor" href="#compat-pre-1.0">带前导零版本号的行为(<code>0.0.x</code> 和 <code>0.x.y</code>)</a><a id="compat-pre-1.0-1"></a><a class="docs-heading-anchor-permalink" href="#compat-pre-1.0" title="Permalink"></a></h3><p>虽然 semver 规范说所有主要版本为 0 的版本（<code>1.0.0</code> 之前的版本）彼此不兼容，但我们决定仅在主要和次要版本号都为零时应用它。换句话说，<code>0.0.1</code> 和 <code>0.0.2</code> 被认为是不兼容的。具有非零次要版本号（<code>0.a.b</code> 且 <code>a != 0</code>）的 <code>pre-1.0</code> 版本，被认为与具有相同次要版本号，以及较小或相等补丁版本号（<code>0.a.c</code> 且 <code>c &lt;= b</code>）的版本兼容；即，版本 <code>0.2.2</code>、<code>0.2.3</code> 与 <code>0.2.1</code>、<code>0.2.0</code> 兼容。主要版本号为 0 及次要版本号不相同的版本被认为是不兼容的，因此版本 0.3.0 可能与 0.2.0 相比具有重大更改。为此， <code>[compat]</code> 条目：</p><pre><code class="language-toml hljs">[compat]
Example = &quot;0.0.1&quot;</code></pre><p>得到 <code>Example</code> 的版本边界为 <code>[0.0.1, 0.0.2)</code>（仅相当于版本 0.0.1），而<code>[compat]</code> 条目：</p><pre><code class="language-toml hljs">[compat]
Example = &quot;0.2.1&quot;</code></pre><p>得到 <code>Example</code> 的版本边界为 <code>[0.2.1, 0.3.0)</code>。</p><p>特别是，当一个包与 <code>0.2.3</code> 相比具有附加功能时，它可能设置 <code>version = &quot;0.2.4&quot;</code>，只要它保持与 <code>0.2.0</code> 的向后兼容。另请参见<a href="../toml-files/#version-字段"><code>version</code> 字段</a>。</p><h3 id="插入说明符"><a class="docs-heading-anchor" href="#插入说明符">插入说明符</a><a id="插入说明符-1"></a><a class="docs-heading-anchor-permalink" href="#插入说明符" title="Permalink"></a></h3><p>插入符号 (<code>^</code>) 说明符允许根据 semver 规则兼容的升级。如果没有使用说明符，这是默认行为。如果新版本没有修改版本说明符中最左边的非零数字，则更新的依赖项被认为是兼容的。</p><p>一些示例如下所示。</p><pre><code class="language-toml hljs">[compat]
PkgA = &quot;^1.2.3&quot; # [1.2.3, 2.0.0)
PkgB = &quot;^1.2&quot;   # [1.2.0, 2.0.0)
PkgC = &quot;^1&quot;     # [1.0.0, 2.0.0)
PkgD = &quot;^0.2.3&quot; # [0.2.3, 0.3.0)
PkgE = &quot;^0.0.3&quot; # [0.0.3, 0.0.4)
PkgF = &quot;^0.0&quot;   # [0.0.0, 0.1.0)
PkgG = &quot;^0&quot;     # [0.0.0, 1.0.0)</code></pre><h3 id="波浪符说明符"><a class="docs-heading-anchor" href="#波浪符说明符">波浪符说明符</a><a id="波浪符说明符-1"></a><a class="docs-heading-anchor-permalink" href="#波浪符说明符" title="Permalink"></a></h3><p>波浪号说明符提供更有限的升级可能性。当指定了主要、次要和补丁版本号时，或指定了主要和次要版本号时，只允许更改补丁版本。如果您只指定一个主要版本，则允许升级次要版本号和补丁版本号（<code>~1</code> 因此等同于 <code>^1</code>）。例如：</p><pre><code class="language-toml hljs">[compat]
PkgA = &quot;~1.2.3&quot; # [1.2.3, 1.3.0)
PkgB = &quot;~1.2&quot;   # [1.2.0, 1.3.0)
PkgC = &quot;~1&quot;     # [1.0.0, 2.0.0)
PkgD = &quot;~0.2.3&quot; # [0.2.3, 0.3.0)
PkgE = &quot;~0.0.3&quot; # [0.0.3, 0.0.4)
PkgF = &quot;~0.0&quot;   # [0.0.0, 0.1.0)
PkgG = &quot;~0&quot;     # [0.0.0, 1.0.0)</code></pre><p>对于主要版本号为 0 的所有版本，波浪说明符和插入说明符是等效的。</p><h3 id="相等说明符"><a class="docs-heading-anchor" href="#相等说明符">相等说明符</a><a id="相等说明符-1"></a><a class="docs-heading-anchor-permalink" href="#相等说明符" title="Permalink"></a></h3><p>相等说明符可用于指定具体的版本：</p><pre><code class="language-toml hljs">[compat]
PkgA = &quot;=1.2.3&quot;           # [1.2.3, 1.2.3]
PkgA = &quot;=0.10.1, =0.10.3&quot; # 0.10.1 or 0.10.3</code></pre><h3 id="不等说明符"><a class="docs-heading-anchor" href="#不等说明符">不等说明符</a><a id="不等说明符-1"></a><a class="docs-heading-anchor-permalink" href="#不等说明符" title="Permalink"></a></h3><p>不等式也可用于指定版本范围：</p><pre><code class="language-toml hljs">[compat]
PkgB = &quot;&gt;= 1.2.3&quot; # [1.2.3,  ∞)
PkgC = &quot;≥ 1.2.3&quot;  # [1.2.3,  ∞)
PkgD = &quot;&lt; 1.2.3&quot;  # [0.0.0, 1.2.3) = [0.0.0, 1.2.2]</code></pre><h3 id="连字说明符"><a class="docs-heading-anchor" href="#连字说明符">连字说明符</a><a id="连字说明符-1"></a><a class="docs-heading-anchor-permalink" href="#连字说明符" title="Permalink"></a></h3><p>连字符语法也可用于指定版本范围。确保连字符的两边都有空格。</p><pre><code class="language-toml hljs">[compat]
PkgA = &quot;1.2.3 - 4.5.6&quot; # [1.2.3, 4.5.6]
PkgA = &quot;0.2.3 - 4.5.6&quot; # [0.2.3, 4.5.6]</code></pre><p>第一个端点中任何未指定的尾随数字都被视为零：</p><pre><code class="language-toml hljs">[compat]
PkgA = &quot;1.2 - 4.5.6&quot;   # [1.2.0, 4.5.6]
PkgA = &quot;1 - 4.5.6&quot;     # [1.0.0, 4.5.6]
PkgA = &quot;0.2 - 4.5.6&quot;   # [0.2.0, 4.5.6]
PkgA = &quot;0.2 - 0.5.6&quot;   # [0.2.0, 0.5.6]</code></pre><p>第二个端点中任何未指定的尾随数字将被视为通配符：</p><pre><code class="language-toml hljs">[compat]
PkgA = &quot;1.2.3 - 4.5&quot;   # 1.2.3 - 4.5.* = [1.2.3, 4.6.0)
PkgA = &quot;1.2.3 - 4&quot;     # 1.2.3 - 4.*.* = [1.2.3, 5.0.0)
PkgA = &quot;1.2 - 4.5&quot;     # 1.2.0 - 4.5.* = [1.2.0, 4.6.0)
PkgA = &quot;1.2 - 4&quot;       # 1.2.0 - 4.*.* = [1.2.0, 5.0.0)
PkgA = &quot;1 - 4.5&quot;       # 1.0.0 - 4.5.* = [1.0.0, 4.6.0)
PkgA = &quot;1 - 4&quot;         # 1.0.0 - 4.*.* = [1.0.0, 5.0.0)
PkgA = &quot;0.2.3 - 4.5&quot;   # 0.2.3 - 4.5.* = [0.2.3, 4.6.0)
PkgA = &quot;0.2.3 - 4&quot;     # 0.2.3 - 4.*.* = [0.2.3, 5.0.0)
PkgA = &quot;0.2 - 4.5&quot;     # 0.2.0 - 4.5.* = [0.2.0, 4.6.0)
PkgA = &quot;0.2 - 4&quot;       # 0.2.0 - 4.*.* = [0.2.0, 5.0.0)
PkgA = &quot;0.2 - 0.5&quot;     # 0.2.0 - 0.5.* = [0.2.0, 0.6.0)
PkgA = &quot;0.2 - 0&quot;       # 0.2.0 - 0.*.* = [0.2.0, 1.0.0)</code></pre><h2 id="修复冲突"><a class="docs-heading-anchor" href="#修复冲突">修复冲突</a><a id="修复冲突-1"></a><a class="docs-heading-anchor-permalink" href="#修复冲突" title="Permalink"></a></h2><p>版本冲突之前是通过 <a href="../managing-packages/#conflicts">example</a> 介绍的，该冲突是由包 <code>D</code> 被其他两个包 <code>B</code> 和 <code>C</code> 使用产生的冲突。我们对错误消息的分析显示 <code>B</code> 使用了 <code>D</code> 的过时版本。要修复它，首先要尝试的是 <code>pkg&gt; dev B</code>以便您可以修改 <code>B</code> 及其兼容性要求。如果您在编辑器中打开它的 <code>Project.toml</code> 文件，您可能会注意到类似</p><pre><code class="language-toml hljs">[compat]
D = &quot;0.1&quot;</code></pre><p>通常第一步是将其修改为类似</p><pre><code class="language-toml hljs">[compat]
D = &quot;0.1, 0.2&quot;</code></pre><p>这表示 <code>B</code> 兼容 0.1 和 0.2 版本；如果你执行 <code>pkg&gt; up</code>，这会修复包错误。但是，您首先需要解决一个主要问题：可能在 <code>D</code> 的 <code>v0.2</code> 版本中存在和 <code>B</code> 不兼容的更改。在继续之前，您应该更新所有包，然后运行 <code>B</code>​​ 的测试，扫描 <code>pkg&gt; test B</code> 的输出以确保 <code>D</code> 的 <code>v0.2</code> 版本实际上正在使用 。（可能有一个 <code>D</code> 的额外的依赖关系将其固定到 <code>v0.1</code>，并且您不希望被误导以为您已经在新版本上测试了 <code>B</code>。）如果使用了新版本并且测试仍然通过，您可以假设B不需要任何特性更新以适应 <code>D</code> 的 <code>v0.2</code> 版本; 您可以安全地将此更改作为拉取请求提交到 <code>B</code> 以便发布新版本。相反，如果抛出错误，则表明 <code>B</code> 需要更广泛的更新以兼容 <code>D</code> 的最新版本。需要完成这些更新，才能同时使用 <code>A</code> 和 <code>B</code>。但是，您可以继续彼此独立地使用它们。</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../creating-packages/">« <strong>5.</strong> 创建包</a><a class="docs-footer-nextpage" href="../registries/"><strong>7.</strong> 注册表 »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 10 November 2022 03:38">Thursday 10 November 2022</span>. Using Julia version 1.9.0-DEV.1786.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
